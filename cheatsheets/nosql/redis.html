<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">



    <meta property="og:site_name" content="Dev Cheatsheets" />

    <title>Redis | Dev Cheatsheets</title>

    <meta property="og:title" content="Redis" />

    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Redis" />
<meta name="generator" content="Jekyll v4.3.3" />

<meta property="og:locale" content="en_US" />


    <meta name="description" content="A collection of code snippets and CLI guides for quick and easy reference while coding" />
    <meta property="og:description" content="A collection of code snippets and CLI guides for quick and easy reference while coding" />
<meta name="author" content="Michael Currin" />



<link rel="canonical" href="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/nosql/redis.html" />
<meta property="og:url" content="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/nosql/redis.html" />


<script type="application/ld+json">
{
    "name":        "Dev Cheatsheets",
    "description": "A collection of code snippets and CLI guides for quick and easy reference while coding",
    "url":         "https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/nosql/redis.html",
    "headline":    "Redis",
    "@type":       "WebSite",
    "@context":    "https://schema.org",
    "author": {
        "@type":"Person",
        "name": "Michael Currin"
    }
}
</script>
<link rel="stylesheet" href="/dev-cheatsheets/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://michaelcurrin.github.io/dev-cheatsheets/feed.xml" title="Dev Cheatsheets" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87705880-12"></script>
    <script>
        window['ga-disable-UA-87705880-12'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
        window.dataLayer = window.dataLayer || [];

        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-87705880-12');
    </script></head>
<body>
<header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/dev-cheatsheets/">
            Dev Cheatsheets
        </a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />

            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path
                            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                    </svg>
                </span>
            </label>

            <div class="trigger"><a class="page-link" href="/dev-cheatsheets/">
                    Home
                </a><a class="page-link" href="/dev-cheatsheets/cheatsheets/">
                    Cheatsheets
                </a><a class="page-link" href="/dev-cheatsheets/about.html">
                    About
                </a><a class="ext-link page-link" href="https://michaelcurrin.github.io/code-cookbook/">
                    <span>Code Cookbook</span>
                    <img src="/dev-cheatsheets/assets/ext-link.svg" />
                </a><a class="ext-link page-link" href="https://michaelcurrin.github.io/dev-resources/">
                    <span>Dev Resources</span>
                    <img src="/dev-cheatsheets/assets/ext-link.svg" />
                </a></div>
        </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a id="github-edit" href="https://github.com/MichaelCurrin/dev-cheatsheets/edit/master/cheatsheets/nosql/redis.md">
    üìù <span>Edit page</span>
</a>

            <a id="github-add" href="https://github.com/MichaelCurrin/dev-cheatsheets/new/master/cheatsheets/nosql/">
    ‚ûï <span>Add page</span>
</a>


            

<article class="post">
    <header class="post-header">
        <h1 class="post-title">
            


            <span>Redis</span>
        </h1>

        
    </header>

    


    <div id="breadcrumbs">

    
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/">
    Cheatsheets
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/nosql/">
    NoSQL
</a>

        
     
        
            /
        

        
            <a href="/dev-cheatsheets/cheatsheets/nosql/redis.html" class="underline">
                Redis
            </a>
        
     
    </div>



    <br>

    <div class="post-content">
        
            <p>A in-memory data structure store, known for high performance as a database, cache, and message broker. It can handel complex data types and large volumes at a speed and with reliability.</p>

<p>Homepage: <a href="https://redis.io/">https://redis.io/</a>.</p>

<h2 id="related">Related</h2>

<ul>
  <li><a href="/dev-cheatsheets/cheatsheets/python/libraries/database/redis/">Redis</a> cheatsheet in the Python libraries section.</li>
</ul>

<h2 id="security-tips">Security tips</h2>

<p>Protect unauthorized data access and manipulation.</p>

<ul>
  <li>Authentication - use strong authentication mechanims so only autherized applications and user have access.</li>
  <li>Use TLS for data transfer between Redis and client apps.</li>
  <li>Network security - Apply firewalls to limit IP access and monitor network traffic.</li>
</ul>

<h2 id="redis-commands">Redis commands</h2>

<p>See <a href="https://redis.io/docs/latest/commands/">Commands</a> on the Redis docs.</p>

<p>Node starter project on GitHub - <a href="https://github.com/redis-developer/redis-nodejs-starter">redis-nodejs-starter</a>.</p>

<p>See <a href="https://redis.io/docs/latest/operate/oss_and_stack/install/install-redis/">Install</a> guides. See commands for your OS and then see the OS-specific instructions to start/stop the Redis server and CLI client.</p>

<h2 id="basics">Basics</h2>

<p>As a NoSQL in-memory database with no schema, Redis is faster than SQL databases for IO.</p>

<h3 id="use-cases">Use cases</h3>

<p>Redis is useful for simple data types and structures where persistance of data is not a priority. Such as:</p>

<ul>
  <li>cache (store frequently-accessed data to reduce response time)</li>
  <li>queue</li>
  <li>session storage for authenticated users</li>
  <li>message brokering for realtime applications</li>
  <li>counter</li>
</ul>

<h3 id="data-types">Data types</h3>

<ul>
  <li>Strings (there are no numbers) - can store text or binary data. Useful for caching info or counters.</li>
  <li>Lists - good for queues or leaderboards where duplicates are allowed.</li>
  <li>Sets - efficient storage for unique items.</li>
  <li>Sorted sets - set but with order. For where order is important such as leaderboard.</li>
  <li>Hashes - represent objects. Attributes can be accessed without retrieving the etire object.</li>
  <li>Streams</li>
</ul>

<p>More advanced:</p>

<ul>
  <li>Bitmaps</li>
  <li>HyperLogLogs</li>
  <li>Geospatial indexes</li>
</ul>

<h3 id="start-and-stop-redis-using-the-shell">Start and stop Redis using the shell</h3>

<p>Add <code class="language-plaintext highlighter-rouge">.exe</code> for Windows.</p>

<h4 id="start-server">Start server</h4>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-server
</code></pre></div></div>

<p>Or start as a service using a package manager for your OS.</p>

<h3 id="start-cli-client">Start CLI client</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli
</code></pre></div></div>

<h2 id="redis-cli">Redis CLI</h2>

<h3 id="get-and-set-scalar-values">Get and set scalar values</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SET key value
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>GET key
</code></pre></div></div>

<p>Add quotes for spaces:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SET <span class="s2">"my key"</span> <span class="s2">"my value"</span>
</code></pre></div></div>

<h3 id="working-with-numeric-data">Working with numeric data</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SET counter 0
<span class="gp">&gt;</span><span class="w"> </span>GET counter
<span class="go">"0"
</span><span class="gp">&gt;</span><span class="w"> </span>INCR counter
<span class="gp">&gt;</span><span class="w"> </span>DECR counter
<span class="gp">&gt;</span><span class="w"> </span>INCRBY counter 4
<span class="gp">&gt;</span><span class="w"> </span>DECRBY counter 2
</code></pre></div></div>

<h3 id="strings">Strings</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>STRLEN key
<span class="go">(integer) 123
</span></code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>APPEND key <span class="s2">" value"</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>GETRANGE key 0 3
</code></pre></div></div>

<h3 id="hashmap">Hashmap</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>HSET key field value <span class="o">[</span>field value...]
<span class="gp">&gt;</span><span class="w"> </span>HSET loggedInUser:123 name <span class="s2">"Foo Bar"</span> url <span class="s2">"https://example.com"</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>HGET loggedInUser:123 name
<span class="go">"Foo Bar"
</span></code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>HMGET loggedInUser:123 name url
<span class="go">1) "Foo Bar"
2) "https://example.com"
</span></code></pre></div></div>

<p>A shopping cart of data for users. The cart is 123 and items are 1 and 2 here.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>HSET cart:123 dev:1:name <span class="s2">"Oranges"</span> dev:1:price <span class="s2">"1.23"</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>HSET cart:123 dev:1:name <span class="s2">"Oranges"</span> dev:1:price <span class="s2">"1.23"</span> dev:2:name <span class="s2">"Bananas"</span>
<span class="gp">&gt;</span><span class="w"> </span>HGETALL cart:123
<span class="go">1) "dev:1:name"
2) "Oranges"
3) "dev:1:price"
4) "1.23"
5) "dev:2:name"
6) "Bananas"
</span><span class="gp">&gt;</span><span class="w"> </span>HLEN cart:123
<span class="go">6
</span></code></pre></div></div>

<h3 id="lists">Lists</h3>

<p>They are implemented as doubly linked lists. Inserting and removing from either end has \(O(1)\) time complexity. Retrieving an element in the middle has \(O(N)\) time complexity since you cannot look up an element by index directly.</p>

<h4 id="length">Length</h4>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LLEN key
</code></pre></div></div>

<h4 id="add-at-start-or-end-with-push">Add at start or end with push</h4>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LPUSH key element <span class="o">[</span>element, ...]
<span class="gp">&gt;</span><span class="w"> </span>RPUSH key element <span class="o">[</span>element, ...]
</code></pre></div></div>

<h4 id="add-next-to-element-insert">Add next to element insert</h4>

<p>This will add before/after the <em>first</em> instance of an existing string.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LINSERT key BEFORE|AFTER pivot element 
</code></pre></div></div>

<p>e.g.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LINSERT key AFTER <span class="s2">"existing"</span> <span class="s2">"new"</span>
</code></pre></div></div>

<h4 id="remove">Remove</h4>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>RPOP key <span class="o">[</span>count]
<span class="gp">&gt;</span><span class="w"> </span>LPOP key <span class="o">[</span>count]
</code></pre></div></div>

<h4 id="view">View</h4>

<p>The indexes are inclusive.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LRANGE key start stop
</code></pre></div></div>

<p>Head element:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LRANGE queue 0 0
</code></pre></div></div>

<p>Tail element:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LRANGE queue <span class="nt">-1</span> <span class="nt">-1</span>
</code></pre></div></div>

<p>Get first 3 elements (at <code class="language-plaintext highlighter-rouge">0</code>, <code class="language-plaintext highlighter-rouge">1</code>, and <code class="language-plaintext highlighter-rouge">2</code>):</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LRANGE queue 0 2
<span class="go">1) "a"
2) "b"
3) "c"
</span></code></pre></div></div>

<p>All elements:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>LRANGE queue 0 <span class="nt">-1</span>
</code></pre></div></div>

<h3 id="sets">Sets</h3>

<p>Sets are useful for data generated externally where the order doesn‚Äôt matter and you don‚Äôt want to have duplicates.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SADD key member <span class="o">[</span>member ...]
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SREM key member
</code></pre></div></div>

<p>Remove a random number of members from the set.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SPOP key <span class="o">[</span>count]
</code></pre></div></div>

<p>Retrieve elements</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SMEMBERS queue
<span class="go">1) abc
2) def
</span></code></pre></div></div>

<h3 id="sorted-set">Sorted set</h3>

<p>Unique elements with order. Give the value and sort index. Change the index and the set will be reordered.</p>

<p>Use-cases:</p>

<ul>
  <li>priority queue</li>
  <li>leaderboard</li>
  <li>task scheduling</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ZADD key score member [score member ...]
</code></pre></div></div>
<p>e.g.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>ZADD <span class="nb">users </span>123 <span class="s2">"foo bar"</span>
<span class="gp">&gt;</span><span class="w"> </span>ZADD <span class="nb">users </span>1000 <span class="s2">"fizz buzz"</span>
</code></pre></div></div>

<p>Get with ascending order.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="c"># Ascending</span>
<span class="gp">&gt;</span><span class="w"> </span>ZRANGE key start stop
<span class="gp">&gt;</span><span class="w"> </span><span class="c"># Descending</span>
<span class="gp">&gt;</span><span class="w"> </span>ZREVRANGE key start stop
</code></pre></div></div>

<p>e.g.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>ZRANGE <span class="nb">users </span>0 1 
<span class="go">1) "foo bar"
2) "fizz buzz"
</span></code></pre></div></div>

<p>Update a member by incrementing their value:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>ZINCRBY key increment member
</code></pre></div></div>

<h2 id="pun-sub-feature">Pun sub feature</h2>

<p>Under fire and forget principle. Data sent to the bus is sent to all consumers. If not consumed by workers, the data are lost.</p>

<p>Works for realtime data transport and is lightweight and easy to use. But data is not persisted.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PUBLISH channel message
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SUBSCRIBE channel [channel ...]
</code></pre></div></div>

<h2 id="streams">Streams</h2>

<p>An append-only data type (not a feature). They <strong>persist</strong> data unless you remove a record. Modelled after log files. You can add complex data as key-value pairs.</p>

<h3 id="add">Add</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>XADD key id field value
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">id</code> is usually <code class="language-plaintext highlighter-rouge">*</code>.</p>

<p>The IDs are unix timestamps.</p>

<p>e.g.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XADD events <span class="k">*</span> user <span class="s2">"joe"</span> event_type <span class="s2">"left-click"</span> coord_x 31 coord_y 50
<span class="go">"1722958057606-0"
</span><span class="gp">&gt;</span><span class="w"> </span>XADD events <span class="k">*</span> user <span class="s2">"joe"</span> event_type <span class="s2">"scroll"</span>
<span class="go">"1722958065294-0"
</span></code></pre></div></div>

<h3 id="read">Read</h3>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XRANGE key start end <span class="o">[</span>COUNT count]
<span class="gp">&gt;</span><span class="w"> </span>XREVRANGE key start end <span class="o">[</span>COUNT count]
</code></pre></div></div>

<p>e.g. All events.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XRANGE events - +
<span class="go">1) 1) "1722958057606-0"
   2) 1) "user"
      2) "joe"
      3) "event_type"
      4) "left-click"
      5) "coord_x"
      6) "32"
      7) "coord_y"
      8) "50"
2) 1) "1722958065294-0"
   2) 1) "user"
      2) "joe"
      3) "event_type"
      4) "scroll"
</span></code></pre></div></div>

<p>You can query a window of time. e.g. The 1st event, using the timestamp of the first event as the max (inclusive).</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XRANGE events - 1722958057606
<span class="go">1) 1) "1722958057606-0"
   2) 1) "user"
      2) "joe"
      3) "event_type"
      4) "left-click"
      5) "coord_x"
      6) "32"
      7) "coord_y"
      8) "50"
</span></code></pre></div></div>

<p>Get a fixed number of events at the start or end.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XRANGE events - + COUNT 1
<span class="gp">&gt;</span><span class="w"> </span>XREVRANGE events + - COUNT 1
</code></pre></div></div>

<h4 id="reading-in-realtime">Reading in realtime</h4>

<p>It‚Äôs similar to pub/sub. Each message is sent to each consumer, except they are not removed from the stream.</p>

<p>Basic:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XREAD STREAMS key <span class="nb">id</span>
</code></pre></div></div>
<p>Full:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XREAD <span class="o">[</span>COUNT count] <span class="o">[</span>BLOCK milliseconds] STREAMS key <span class="o">[</span>key ...] <span class="nb">id</span> <span class="o">[</span><span class="nb">id</span> ...]
</code></pre></div></div>

<p>e.g.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XREAD BLOCK 0 STREAMS events <span class="err">$</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>XADD events <span class="k">*</span> user <span class="s2">"bob"</span> event_type <span class="s2">"scroll"</span>
</code></pre></div></div>

<h2 id="keyspace-notifications">Keyspace notifications</h2>

<p>Get notified when data enters or leaves Redis. Also timeout and time-based notifications.</p>

<h3 id="user-login-timeout-example">User login timeout example</h3>

<p>Here we logout a user after a set time and also send a keyspace notification about it which we can subscribe to.</p>

<p>With EX you can set TTL (time to live).</p>

<p>For example, login a user and set expiration of an hour with 3600 seconds (user will remove the key after this). T=T==</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SET logged_in_user:1234 123456789 EX 3600
</code></pre></div></div>

<p>Then again with the <code class="language-plaintext highlighter-rouge">XX</code> flag which will update an existing value and return <code class="language-plaintext highlighter-rouge">-1</code> if they key does not yet exist.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>SET logged_in_user:1234 123456789 EX 3600 XX
</code></pre></div></div>

<p>Subscribe to expiration events:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli <span class="nt">--csv</span> psubscribe <span class="s1">'__key*__:expired'</span>
</code></pre></div></div>

<h2 id="scaling">Scaling</h2>

<p>Needs:</p>

<ul>
  <li>Scaling - storage capacity and processing can grow.</li>
  <li>High availability - always available even if some servers have issues.</li>
  <li>Partition tolerance - if the network is partioned, and some are disconnected, Redis must still work.</li>
</ul>

<p>Solutions:</p>

<h3 id="clusters">Clusters</h3>

<ul>
  <li>To distribute data and load.</li>
  <li>There is time to sync between clusters, so the queried result for two clusters could be different, but it will always be available.</li>
</ul>

<p>Features:</p>

<ul>
  <li>No limit to storage and always available.</li>
  <li>The storage capacity can grow outside the limits of the memory of a single node.</li>
  <li>Elastic capacity - can scale up and down with demand.</li>
  <li>Data sharding (information is distributed based on key and algorithm, info is distributed so one server doesn‚Äôt get overloaded) and data replication (highly available, data replicated on other servers). Just needs configuration.</li>
  <li>Client transparency - client connector works the same with and without a cluster.</li>
</ul>

<h4 id="example-setup">Example setup</h4>

<p>Start some servers using a config file for each and running on a different port.</p>

<p>Then start the cluster using, where info is replicated from each node to 1 other.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli <span class="nt">--cluster</span> create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 <span class="nt">--cluster-replicas</span> 1
</code></pre></div></div>

<h2 id="sentinel">Sentinel</h2>

<p>A pattern of master and replicas. So if master goes down, the replica can be promoted.</p>

<p>Provides monitoring and failover for your Redis instances.</p>

<ol>
  <li>Start your instances, each with a config.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span>redis-cli ./redis.conf
</code></pre></div>    </div>
  </li>
  <li>Start your sentinels, each with a config.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span>redis-sentinel ./sentinel.conf
</code></pre></div>    </div>
  </li>
</ol>

        
    </div>
</article>

        </div>
    </main>
<footer class="site-footer h-card">
    <data class="u-url" href="/dev-cheatsheets/"></data>

    <div class="wrapper">

        <h2 class="footer-heading">Dev Cheatsheets</h2>

        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list"><li class="p-name">
                            Michael Currin
                        </li></ul>
            </div>

            <div class="footer-col footer-col-2">
<ul class="social-media-list"><li>
        <a href="https://github.com/MichaelCurrin"><svg
                class="svg-icon">
                <use xlink:href="/dev-cheatsheets/assets/fractal-social-icons.svg#github">
                </use>
            </svg> <span class="username">MichaelCurrin</span></a>
    </li></ul>
</div>

            <div class="footer-col footer-col-3">
                <p>A collection of code snippets and CLI guides for quick and easy reference while coding</p>
            </div>
        </div>

    </div>

</footer>
<a href="https://github.com/MichaelCurrin/dev-cheatsheets"
    class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

</body>

</html>
