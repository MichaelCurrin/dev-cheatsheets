<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Bundling | Dev Cheatsheets</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Bundling" />
<meta name="author" content="Michael Currin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Generate a single JS file from your TS modules" />
<meta property="og:description" content="Generate a single JS file from your TS modules" />
<link rel="canonical" href="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/javascript/deno/cli/bundling.html" />
<meta property="og:url" content="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/javascript/deno/cli/bundling.html" />
<meta property="og:site_name" content="Dev Cheatsheets" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bundling" />
<script type="application/ld+json">
{"headline":"Bundling","description":"Generate a single JS file from your TS modules","url":"https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/javascript/deno/cli/bundling.html","author":{"@type":"Person","name":"Michael Currin"},"@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/dev-cheatsheets/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://michaelcurrin.github.io/dev-cheatsheets/feed.xml" title="Dev Cheatsheets" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87705880-12"></script>
    <script>
        window['ga-disable-UA-87705880-12'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
        window.dataLayer = window.dataLayer || [];

        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-87705880-12');
    </script></head>
<body>
<header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/dev-cheatsheets/">
            Dev Cheatsheets
        </a><nav class="site-nav">
                <input type="checkbox" id="nav-trigger" class="nav-trigger" />

                <label for="nav-trigger">
                    <span class="menu-icon">
                        <svg viewBox="0 0 18 15" width="18px" height="15px">
                            <path
                                d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                        </svg>
                    </span>
                </label>

                <div class="trigger"><a class="page-link" href="/dev-cheatsheets/">
                                Home
                            </a><a class="page-link" href="/dev-cheatsheets/cheatsheets/">
                                Cheatsheets
                            </a><a class="page-link" href="/dev-cheatsheets/about.html">
                                About
                            </a></div>
            </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a id="github-edit" href="https://github.com/MichaelCurrin/dev-cheatsheets/edit/master/cheatsheets/javascript/deno/cli/bundling.md">
    üìù <span>Edit page</span>
</a>

            <a id="github-add" href="https://github.com/MichaelCurrin/dev-cheatsheets/new/master/cheatsheets/javascript/deno/cli/">
    ‚ûï <span>Add page</span>
</a>


            

<article class="post">
    <header class="post-header">
        <h1 class="post-title">
            


            <span>Bundling</span>
        </h1>

        
            <blockquote>
                <p>Generate a single JS file from your TS modules</p>

            </blockquote>
        
    </header>

    


    <div id="breadcrumbs">

    
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/">
    Cheatsheets
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/javascript/">
    JavaScript
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/javascript/deno/">
    Deno
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/javascript/deno/cli/">
    CLI
</a>

        
     
        
            /
        

        
            <a href="/dev-cheatsheets/cheatsheets/javascript/deno/cli/bundling.html" class="underline">
                Bundling
            </a>
        
     
    </div>



    <br>

    <div class="post-content">
        
            <p>This includes imported modules - both your scripts and external packages.</p>

<h2 id="cli-usage">CLI usage</h2>

<p>See my <a href="/dev-cheatsheets/cheatsheets/javascript/deno/cli/commands/bundle.html">deno bundle</a> page.</p>

<h2 id="how-to-run-the-bundled-file">How to run the bundled file</h2>

<p>See more details in the <a href="https://deno.land/manual/tools/bundler">bundle</a> manual.</p>

<h2 id="where-you-bundle-can-run">Where you bundle can run</h2>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Deno - <code class="language-plaintext highlighter-rouge">deno run build/bundle.js</code></li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Browser - load as an ES Module.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Node - <code class="language-plaintext highlighter-rouge">node run build/bundle.js</code> this could work if you really wanted to.</li>
</ul>

<p>Warning:</p>

<p>If you use a Deno package in the code that gets bundled, you‚Äôll have a <code class="language-plaintext highlighter-rouge">Deno</code> object in the input. Then you cannot run the JS script outside of Deno (like with Node or in the browser). However, if you are careful to bundle only code from CDNs that rely on NPM and not Deno, then your bundled JS code can be run outside of Deno.</p>

<h3 id="run-with-deno">Run with Deno</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>deno run build/bundle.js
</code></pre></div></div>

<h3 id="import-in-scripts">Import in scripts</h3>

<p>The output file is an ES module, so you can do imports from it as with JS modules in general.</p>

<p>For example, from the docs:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">lib.bundle.js</code>
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">export</span> <span class="p">{</span> <span class="nx">foo</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./foo.js</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Note export from another module, without an import.</span>

  <span class="k">export</span> <span class="kd">const</span> <span class="nx">bar</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">bar</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">main.js</code>
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">import</span> <span class="p">{</span> <span class="nx">bar</span><span class="p">,</span> <span class="nx">foo</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./lib.bundle.js</span><span class="dl">"</span><span class="p">;</span>

  <span class="nx">foo</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Though, the idea is that the bundle is a single JS file, so perhaps the <code class="language-plaintext highlighter-rouge">foo.js</code> use above would actually (once compiled) be bundled inside the lib script instead of as a separate file.</p>

<h3 id="browser">Browser</h3>

<p>You might distribute your bundle for others to download and use. Or you might use as part of your own web app.</p>

<p>For example, if you have these in a <code class="language-plaintext highlighter-rouge">public</code> directory:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">index.html</code></li>
  <li><code class="language-plaintext highlighter-rouge">main.bundle.js</code></li>
</ul>

<p>Then in your HTML file, you could do:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span> <span class="na">src=</span><span class="s">"main.bundle.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>Or use in an inline script.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;</span>
  <span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">website</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">main.bundle.js</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">import</span> <span class="p">{</span> <span class="nx">fizz</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">buzz.bundle.js</span><span class="dl">"</span><span class="p">;</span>

<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Note that if you use anything Deno-specific, it won‚Äôt be recognized.</p>

<p>e.g. <code class="language-plaintext highlighter-rouge">Deno.args</code>, which is intended for the CLI anyway.</p>

<h2 id="optmization-production-builds">Optmization production builds</h2>

<h3 id="minification">Minification</h3>

<p>In production, you‚Äôd probably want to use a minification tool to minify your JS bundle. Deno and Node do not have anything built-in to support this but you can find package to do this.</p>

<p>Deno does not currently support JS minification yet - see <a href="https://github.com/denoland/deno/issues/6900">issue #6900</a>.</p>

<p>You can of course run a separate <a href="https://michaelcurrin.github.io/dev-resources/resources/javascript/minifiers.html">Minifier</a> tool over the Deno output.</p>

<p>Suggestion from issue comments:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>deno bundle https://deno.land/std@0.79.0/http/file_server.ts <span class="se">\</span>
  | esbuild <span class="nt">--minify</span> <span class="o">&gt;</span> file_server.min.js
<span class="nv">$ </span>deno run <span class="nt">--allow-net</span> <span class="nt">--allow-read</span> file_server.min.js
</code></pre></div></div>

<p>Or minify a file which was bundled already using Deno.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>build/bundle.js <span class="se">\</span>
  | npx esbuild <span class="nt">--minify</span> <span class="se">\</span>
  <span class="o">&gt;</span> build/bundle.min.js
</code></pre></div></div>

<p>The minfied version was 1/3 of the 1MB file.</p>

<p>That uses <code class="language-plaintext highlighter-rouge">npx</code>, assuming Node is installed, but without having to install ESBuild first.</p>

<h3 id="unique-names">Unique names</h3>

<p>You probably also want to use unique names for each production build. This ensures that a user gets the latest JS app, instead of the browser caching and reusing an old <code class="language-plaintext highlighter-rouge">bundle.js</code> file.</p>

<p>Such as creating as using a Git tag, like <code class="language-plaintext highlighter-rouge">bundle-1.2.3.js</code></p>

<p>Or using a computed hash, like <code class="language-plaintext highlighter-rouge">bundle-abcdef12.js</code>.</p>

        
    </div>
</article>

        </div>
    </main>
<footer class="site-footer h-card">
    <data class="u-url" href="/dev-cheatsheets/"></data>

    <div class="wrapper">

        <h2 class="footer-heading">Dev Cheatsheets</h2>

        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list"><li class="p-name">
                            Michael Currin
                        </li></ul>
            </div>

            <div class="footer-col footer-col-2">
<ul class="social-media-list"><li>
            <a href="https://github.com/MichaelCurrin"><svg class="svg-icon">
                    <use xlink:href="/dev-cheatsheets/assets/fractal-social-icons.svg#github"></use>
                </svg> <span class="username">MichaelCurrin</span></a>
        </li></ul>
</div>

            <div class="footer-col footer-col-3">
                <p>A collection of code snippets and CLI guides for quick and easy reference while coding</p>
            </div>
        </div>

    </div>

</footer>
<a href="https://github.com/MichaelCurrin/dev-cheatsheets"
    class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

</body>

</html>
