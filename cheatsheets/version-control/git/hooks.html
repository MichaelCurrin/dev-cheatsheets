<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">



    <meta property="og:site_name" content="Dev Cheatsheets" />

    <title>Hooks | Dev Cheatsheets</title>

    <meta property="og:title" content="Hooks" />

    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Hooks" />
<meta name="generator" content="Jekyll v4.2.1" />

<meta property="og:locale" content="en_US" />


    <meta name="description" content="Understanding and using git hooks" />
    <meta property="og:description" content="Understanding and using git hooks" />
<meta name="author" content="Michael Currin" />



<link rel="canonical" href="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/version-control/git/hooks.html" />
<meta property="og:url" content="https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/version-control/git/hooks.html" />


<script type="application/ld+json">
{
    "name":        "Dev Cheatsheets",
    "description": "Understanding and using git hooks",
    "url":         "https://michaelcurrin.github.io/dev-cheatsheets/cheatsheets/version-control/git/hooks.html",
    "headline":    "Hooks",
    "@type":       "WebSite",
    "@context":    "https://schema.org",
    "author": {
        "@type":"Person",
        "name": "Michael Currin"
    }
}
</script>
<link rel="stylesheet" href="/dev-cheatsheets/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://michaelcurrin.github.io/dev-cheatsheets/feed.xml" title="Dev Cheatsheets" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87705880-12"></script>
    <script>
        window['ga-disable-UA-87705880-12'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
        window.dataLayer = window.dataLayer || [];

        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-87705880-12');
    </script></head>
<body>
<header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/dev-cheatsheets/">
            Dev Cheatsheets
        </a><nav class="site-nav">
                <input type="checkbox" id="nav-trigger" class="nav-trigger" />

                <label for="nav-trigger">
                    <span class="menu-icon">
                        <svg viewBox="0 0 18 15" width="18px" height="15px">
                            <path
                                d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                        </svg>
                    </span>
                </label>

                <div class="trigger"><a class="page-link" href="/dev-cheatsheets/">
                                Home
                            </a><a class="page-link" href="/dev-cheatsheets/cheatsheets/">
                                Cheatsheets
                            </a><a class="page-link" href="/dev-cheatsheets/about.html">
                                About
                            </a></div>
            </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a id="github-edit" href="https://github.com/MichaelCurrin/dev-cheatsheets/edit/master/cheatsheets/version-control/git/hooks.md">
    üìù <span>Edit page</span>
</a>

            <a id="github-add" href="https://github.com/MichaelCurrin/dev-cheatsheets/new/master/cheatsheets/version-control/git/">
    ‚ûï <span>Add page</span>
</a>


            

<article class="post">
    <header class="post-header">
        <h1 class="post-title">
            


            <span>Hooks</span>
        </h1>

        
            <blockquote>
                <p>Understanding and using git hooks</p>

            </blockquote>
        
    </header>

    


    <div id="breadcrumbs">

    
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/">
    Cheatsheets
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/version-control/">
    Version control
</a>

        
     
        
            /
        

        
            
            <a href="/dev-cheatsheets/cheatsheets/version-control/git/">
    Git
</a>

        
     
        
            /
        

        
            <a href="/dev-cheatsheets/cheatsheets/version-control/git/hooks.html" class="underline">
                Hooks
            </a>
        
     
    </div>



    <br>

    <div class="post-content">
        
            <h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://githooks.com/">githooks.com</a> homepage
    <ul>
      <li>It has a nice ‚ÄúReading‚Äù section with info.</li>
      <li>The ‚ÄúProjects‚Äù section shows existing projects you can integrate with.
        <ul>
          <li>A couple of hook managers.</li>
          <li>This one prevents bad Python commits - <a href="https://pypi.org/project/git-pre-commit-hook/">git-pre-commit-hook</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://git-scm.com/docs/githooks">Git Hooks</a> in the Git docs
    <ul>
      <li>How hooks work</li>
      <li>The hook types and descriptions.</li>
      <li>Here is the source file - <a href="https://github.com/git/git/blob/master/Documentation/githooks.txt">githooks.txt</a></li>
    </ul>
  </li>
  <li><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Customizing Git - Git Hooks</a> in the Git docs</li>
  <li>Repos
    <ul>
      <li><a href="https://github.com/topics/commit-msg">#commit-msg</a> GitHub topic</li>
      <li><a href="https://github.com/alan-agius4/speedy-commit-msg-hook">speedy-commit-msg-hook</a> - NPM package to validate a commit message. This also includes an install step in <code class="language-plaintext highlighter-rouge">src</code> irectory.</li>
      <li><a href="https://github.com/pre-commit/pre-commit-hooks">pre-commit/pre-commit-hooks</a> GH repo</li>
    </ul>
  </li>
  <li><a href="https://pre-commit.com/">pre-commit.com</a> homepage
    <ul>
      <li>Good for use with Python projects.</li>
    </ul>
  </li>
</ul>

<h3 id="integrations">Integrations</h3>

<p>The shell will follow your hook, but VS Code will not use. Well, in my experience is actually uses the commit message hook when you commit with the UI, but the hook cannot use any input values so it ends up being a dumb message generator that ignores what you write if you have a custom mssage.</p>

<p>Here are some GH issues around preparing commit message.</p>

<ul>
  <li><a href="https://github.com/microsoft/vscode/issues/94274">Git: Support prepare-commit-msg hook</a> for VS Code. Closed issue.</li>
  <li><a href="https://github.com/microsoft/vscode/issues/30562">Git: Support editing the commit message in a text editor</a> for VS Code. Open issue.</li>
</ul>

<p>Note that VS Code does follow the <a href="https://github.com/MichaelCurrin/learn-to-code/blob/master/en/topics/version_control/Git/configure/commit_message_template.md">commit template</a> file though - this can be useful for a branch description or ticket number. Unfortunately writing to this file at the <em>commit</em> step is too late, as the template will have already been used in the hook. You could run a script every second to update the template file so it is always ready when you commit in the VS Code UI (which picks that up every few seconds) - that is just a lot of noise and processing to run it continously.</p>

<h2 id="setting-up-hooks">Setting up hooks</h2>

<p>Note that if you store hooks in a directory like <code class="language-plaintext highlighter-rouge">hooks</code>, you‚Äôll need a manual step on installation to copy them to <code class="language-plaintext highlighter-rouge">.git/hooks</code>.</p>

<p>See also my <a href="https://michaelcurrin.github.io/code-cookbook/recipes/jekyll/hooks.html">Jekyll Hooks</a> recipe.</p>

<h3 id="copy">Copy</h3>

<p>Here we use a file from version control in <code class="language-plaintext highlighter-rouge">hooks/</code> directory with the name and copy it to Git‚Äôs hooks directory of <code class="language-plaintext highlighter-rouge">.git/hooks</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cp </span>hooks/pre-commit-msg .git/hooks/pre-commit-msg
</code></pre></div></div>

<p>You should make the file executable in version control for ease.</p>

<p>If it wasn‚Äôt executable, you‚Äôll need to change it now:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">chmod</span> +x .git/hooks/pre-commit-msg
</code></pre></div></div>

<h3 id="add-symlink">Add symlink</h3>

<p>An alternative which keeps the Git hooks in sync with the file in version control, so you never have to remmeber to copy after a change.</p>

<p>We‚Äôll get this in <code class="language-plaintext highlighter-rouge">.git/hooks</code>, when viewed with <code class="language-plaintext highlighter-rouge">ls -l</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pre-push -&gt; ../../hooks/pre-push
</code></pre></div></div>

<p>Make sure the file is executable in version control.</p>

<p>Then add a link inside the Git hooks using either approach:</p>

<ul>
  <li>Linux and macOS.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">cd</span> .git/hooks
  <span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-s</span> ../../hooks/pre-push pre-push
</code></pre></div>    </div>
  </li>
  <li>Linux - using GNU <code class="language-plaintext highlighter-rouge">ls</code> which supports <code class="language-plaintext highlighter-rouge">-r</code>.
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-s</span> <span class="nt">-r</span> hooks/pre-commit-msg .git/hooks/pre-commit-msg
</code></pre></div>    </div>
  </li>
</ul>

<p>See my <a href="https://github.com/MichaelCurrin/badge-generator/blob/master/Makefile">Badge Generator Makefile</a> to see this in use.</p>

<h3 id="reset">Reset</h3>

<p>You can also <em>reset</em> the Git hooks directory to remove any of your changes, using this in an existing repo.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git init
</code></pre></div></div>

<blockquote>
  <p>It‚Äôs important to note that client-side hooks are not copied when you clone a repository. If your intent with these scripts is to enforce a policy, you‚Äôll probably want to do that on the server side; see the example in <a href="https://git-scm.com/book/en/v2/Customizing-Git-An-Example-Git-Enforced-Policy#_an_example_git_enforced_policy">An Example Git-Enforced Policy</a>.</p>
</blockquote>

<h2 id="hook-samples">Hook samples</h2>

<p>You get a few sample hook files in a <code class="language-plaintext highlighter-rouge">.git</code> directory which you can rename to use. Or create a new file.</p>

<h2 id="all-hook-types">All hook types</h2>

<p>Copied from githooks homepage. I‚Äôve grouped for convenience.</p>

<h3 id="patch">Patch</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">applypatch-msg</code></li>
  <li><code class="language-plaintext highlighter-rouge">pre-applypatch</code></li>
  <li><code class="language-plaintext highlighter-rouge">post-applypatch</code></li>
</ul>

<h3 id="commit">Commit</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pre-commit</code>
    <ul>
      <li>Allows editing of contents of a commit - not ideal for updating message.</li>
      <li>This is invoked using <code class="language-plaintext highlighter-rouge">git commit</code>, before obtaining the commit log message</li>
      <li>It takes no parameters.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">prepare-commit-msg</code>
    <ul>
      <li>Allow updating commit message in place before the user sees it. ‚ÄúYou may use it in conjunction with a commit template to programmatically insert information.‚Äù</li>
      <li>This invoked <code class="language-plaintext highlighter-rouge">git commit</code> right after preparing the default log message, but before the editor is started.</li>
      <li>Params - It takes one to three parameters:
        <ol>
          <li>The first is the <strong>name of the file</strong> that contains the commit log message.</li>
          <li>The second is the <strong>source</strong> or type of the commit message, and can be:
            <ul>
              <li><code class="language-plaintext highlighter-rouge">message</code> (if the <code class="language-plaintext highlighter-rouge">-m</code> or <code class="language-plaintext highlighter-rouge">-F</code> option was given)</li>
              <li><code class="language-plaintext highlighter-rouge">template</code> (if the <code class="language-plaintext highlighter-rouge">-t</code> option was given or the configuration option <code class="language-plaintext highlighter-rouge">commit.template</code> is set)</li>
              <li><code class="language-plaintext highlighter-rouge">merge</code> (if the commit is a merge or a .<code class="language-plaintext highlighter-rouge">git/MERGE_MSG</code> file exists)</li>
              <li><code class="language-plaintext highlighter-rouge">squash</code> (if a <code class="language-plaintext highlighter-rouge">.git/SQUASH_MSG</code> file exists)</li>
              <li><code class="language-plaintext highlighter-rouge">commit</code></li>
            </ul>
          </li>
          <li>The commit hash - SHA-1 for an amended commit (if a <code class="language-plaintext highlighter-rouge">-c</code>, <code class="language-plaintext highlighter-rouge">-C</code> or <code class="language-plaintext highlighter-rouge">--amend</code> option was given).</li>
        </ol>
      </li>
      <li>Aborting
        <ul>
          <li>If the exit status is non-zero, git commit will abort.</li>
        </ul>
      </li>
      <li>The <code class="language-plaintext highlighter-rouge">sample prepare-commit-msg</code> hook that comes with Git removes the help message found in the commented portion of the commit template.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">commit-msg</code>
    <ul>
      <li>This is invoked by <code class="language-plaintext highlighter-rouge">git commit</code> and <code class="language-plaintext highlighter-rouge">git merge</code>.</li>
      <li>Params
        <ul>
          <li>It takes a single parameter.
            <ol>
              <li>The <strong>name of the file</strong> that holds the proposed commit log message.</li>
            </ol>
          </li>
        </ul>
      </li>
      <li>Aborting
        <ul>
          <li>Exiting with an error status causes the command to <strong>abort</strong>.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">post-commit</code>
    <ul>
      <li>This is used primarily for notification and cannot affect the outcome of a commit.</li>
    </ul>
  </li>
</ul>

<h3 id="merging-and-branches">Merging and branches</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pre-rebase</code></li>
  <li><code class="language-plaintext highlighter-rouge">post-checkout</code></li>
  <li><code class="language-plaintext highlighter-rouge">post-merge</code></li>
</ul>

<h3 id="receive-and-update">Receive and update</h3>

<p>I don‚Äôt know what these are for.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pre-receive</code></li>
  <li><code class="language-plaintext highlighter-rouge">update</code></li>
  <li><code class="language-plaintext highlighter-rouge">post-receive</code></li>
  <li><code class="language-plaintext highlighter-rouge">post-update</code></li>
</ul>

<h3 id="clean">Clean</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pre-auto-gc</code></li>
</ul>

<h3 id="rewrite">Rewrite</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">post-rewrite</code></li>
</ul>

<h3 id="push">Push</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pre-push</code></li>
</ul>

        
    </div>
</article>

        </div>
    </main>
<footer class="site-footer h-card">
    <data class="u-url" href="/dev-cheatsheets/"></data>

    <div class="wrapper">

        <h2 class="footer-heading">Dev Cheatsheets</h2>

        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
                <ul class="contact-list"><li class="p-name">
                            Michael Currin
                        </li></ul>
            </div>

            <div class="footer-col footer-col-2">
<ul class="social-media-list"><li>
            <a href="https://github.com/MichaelCurrin"><svg class="svg-icon">
                    <use xlink:href="/dev-cheatsheets/assets/fractal-social-icons.svg#github"></use>
                </svg> <span class="username">MichaelCurrin</span></a>
        </li></ul>
</div>

            <div class="footer-col footer-col-3">
                <p>A collection of code snippets and CLI guides for quick and easy reference while coding</p>
            </div>
        </div>

    </div>

</footer>
<a href="https://github.com/MichaelCurrin/dev-cheatsheets"
    class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

</body>

</html>
